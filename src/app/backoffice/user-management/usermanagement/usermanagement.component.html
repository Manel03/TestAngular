<app-showuserdetails #userDetailsModal></app-showuserdetails>

<div class="header-title">
  <h2>Gestion des utilisateurs</h2>
</div>

<!-- Champ de recherche -->
<fieldset class="search-filters">
  <legend>Filtrer les utilisateurs</legend>
  <div class="search-fields">
    <div class="first-row">
      <input type="text" pInputText placeholder="Email" [(ngModel)]="searchCriteria.email">
      <input type="text" pInputText placeholder="Prénom" [(ngModel)]="searchCriteria.firstName">
      <input type="text" pInputText placeholder="Nom" [(ngModel)]="searchCriteria.lastName">
    </div>
    <div class="second-row">
      <p-dropdown [options]="statusOptions" [(ngModel)]="searchCriteria.enabled" placeholder="Statut" class="dropdown"></p-dropdown>
      <div class="buttons">
        <button pButton type="button" label="Rechercher" icon="pi pi-search" (click)="filterUsers()"></button>
        <button pButton type="button" label="Réinitialiser" icon="pi pi-refresh" (click)="resetFilters()"></button>
      </div>
    </div>
  </div>
</fieldset>
<div class="custom-table-container">
<p-table [value]="filteredUsers" [paginator]="true" [rows]="10" responsiveLayout="scroll" class="custom-table">
  <ng-template pTemplate="header">
    <tr>
      <th>Email</th>
      <th>Prénom</th>
      <th>Nom</th>
      <th>Statut</th>
      <th>
        <!-- Ajouter l'utilisateur ici, dans la même colonne que les actions -->
        <button pButton type="button" icon="pi pi-plus" label="Actions" (click)="addUser()" class="add-user-button"></button>
      </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-user>
    <tr>
      <td>{{ user.email }}</td>
      <td>{{ user.firstName }}</td>
      <td>{{ user.lastName }}</td>
      <td>{{ user.enabled ? 'Actif' : 'Désactivé' }}</td>
      <td class="action-buttons">
        <div style="display: flex; gap: 4px;">
          <button pButton type="button" icon="pi pi-pencil" (click)="editUser(user)"></button>
          <button pButton type="button" icon="pi pi-info-circle" (click)="showUserDetails(user, userDetailsModal)"></button>
          <button pButton type="button" icon="pi pi-trash" (click)="confirmDelete(user.id)"></button>
        </div>
      </td>
    </tr>
  </ng-template>
</p-table>
</div>
<p-confirmDialog></p-confirmDialog>
